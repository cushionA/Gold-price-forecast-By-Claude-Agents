{
  "feature": "dxy",
  "attempt": 1,
  "source": "entrance",
  "phase": "phase2_submodel",

  "objective": "Extract dollar momentum regime, cross-currency divergence, and volatility state features from DXY and its 6 constituent currency pairs. Exploit the daily-frequency advantage that real_rate lacked to provide actionable context beyond the raw DXY level already in base features.",

  "requirements": "Build a submodel that captures: (1) DXY momentum regime (trending vs mean-reverting periods), (2) cross-currency agreement/divergence (are all 6 components moving together, or is EUR driving DXY while JPY diverges?), (3) dollar volatility regime (calm vs turbulent). Output 2-4 daily features that enrich the meta-model's understanding of USD dynamics beyond the raw level.",

  "theoretical_background": {
    "why_dxy_matters": "Gold is priced in USD. A stronger dollar mechanically reduces gold's USD price. But the relationship is not constant: during risk-off events, both USD and gold can rise simultaneously (safe-haven co-movement). The submodel should capture WHEN the standard inverse relationship holds vs breaks down.",
    "what_base_feature_provides": "dxy_dxy is the raw DXY close price (single daily value). It tells the meta-model the current dollar level but not: (a) whether the dollar is in a trending or mean-reverting regime, (b) whether all constituent currencies agree on USD direction, (c) whether FX volatility is elevated.",
    "what_submodel_adds": "Context about the dollar's DYNAMICS and STRUCTURE that a single level reading cannot convey. A DXY at 95 in a strong uptrend with high cross-currency agreement has very different implications for gold than DXY at 95 oscillating in a range with divergent currency signals.",
    "multi_currency_advantage": "DXY is a weighted index of 6 currencies (EUR 57.6%, JPY 13.6%, GBP 11.9%, CAD 9.1%, SEK 4.2%, CHF 3.6%). Decomposing into individual pairs reveals hidden structure: e.g., EUR weakening while JPY strengthens signals different macro regimes than both weakening together."
  },

  "data_strategy": {
    "primary_data": {
      "source": "Yahoo Finance",
      "ticker": "DX-Y.NYB",
      "frequency": "daily",
      "available_from": "2015-01-02",
      "note": "Already in data/raw/dxy.csv"
    },
    "expansion_data": {
      "source": "Yahoo Finance",
      "tickers": [
        {"symbol": "EURUSD=X", "weight_in_dxy": 0.576, "note": "Largest DXY component"},
        {"symbol": "JPY=X", "weight_in_dxy": 0.136, "note": "USD/JPY"},
        {"symbol": "GBPUSD=X", "weight_in_dxy": 0.119, "note": "GBP/USD"},
        {"symbol": "CAD=X", "weight_in_dxy": 0.091, "note": "USD/CAD"},
        {"symbol": "SEK=X", "weight_in_dxy": 0.042, "note": "USD/SEK"},
        {"symbol": "CHF=X", "weight_in_dxy": 0.036, "note": "USD/CHF"}
      ],
      "frequency": "daily",
      "note": "All daily -- NO interpolation needed. This is the critical advantage over real_rate."
    },
    "expected_samples": "~2500 daily observations (matching base_features date range 2015-01-30 to 2025-02-12)"
  },

  "research_questions": [
    "What methods are most effective for detecting momentum vs mean-reversion regimes in FX markets? Candidates: Hidden Markov Model, threshold autoregressive model (TAR), Markov-switching model. Which has the best track record for daily FX data?",
    "How to quantify cross-currency divergence within a currency index? Candidates: PCA on daily currency returns (PC1 = common factor, residuals = divergence), pairwise correlation rolling window, dispersion index (std of individual currency returns). Which provides the most informative signal?",
    "What is the empirical evidence on DXY-gold correlation regime shifts? When does the standard negative correlation break down (e.g., 2008 crisis, 2020 COVID)? How frequent are these regime shifts?",
    "What lookback windows are appropriate for FX momentum and volatility features? Literature suggests 5/10/20/60 day windows. Is there consensus on optimal lookback for gold-relevant FX signals?",
    "Are there known seasonality or day-of-week effects in DXY that could create spurious patterns? Should we control for these?",
    "What is the relationship between FX implied volatility and gold returns? Can realized volatility of currency pairs serve as a useful proxy?",
    "How should cross-currency features be normalized to avoid VIF issues with the raw dxy_dxy base feature? The submodel output must have VIF < 10 against existing base features."
  ],

  "candidate_approaches": {
    "approach_A_regime_features": {
      "description": "Markov-Switching Model on DXY returns to detect 2-3 regimes (strong trend / range-bound / volatile). Output regime probabilities as daily features.",
      "pros": "Well-established in FX literature, directly captures what base feature misses",
      "cons": "Single-series approach, does not use multi-currency info"
    },
    "approach_B_pca_divergence": {
      "description": "PCA on daily returns of 6 constituent currencies. PC1 captures common USD movement, residual variance captures cross-currency divergence. Output PC1 loading strength + divergence ratio.",
      "pros": "Exploits multi-currency structure, deterministic, no overfitting risk",
      "cons": "PCA is linear, may miss nonlinear regime patterns"
    },
    "approach_C_hybrid": {
      "description": "Combine regime detection (HMM/Markov-switching on DXY) with cross-currency divergence (PCA residual). Output 3-4 features: regime_state, regime_probability, cross_currency_divergence, fx_volatility_state.",
      "pros": "Captures both temporal dynamics and structural decomposition",
      "cons": "More complex, but daily data makes this feasible"
    }
  },

  "constraints": [
    "All data is daily frequency -- NO monthly-to-daily interpolation permitted (key lesson from real_rate)",
    "5-day data delay rule: All Yahoo Finance daily FX data is same-day or T+1, well within limit",
    "Submodel does NOT predict gold prices -- it extracts USD regime/structure features",
    "Output must have VIF < 10 against existing base features (especially raw dxy_dxy)",
    "Maximum 2-4 output columns to avoid noise amplification (real_rate lesson: 7 columns caused worst Gate 3 degradation)",
    "Output must not have autocorrelation > 0.99 (real_rate attempt 1 failure)",
    "Features must be computable at inference time without lookahead bias"
  ],

  "output_schema": {
    "target_columns": 3,
    "target_range": "2-4 columns",
    "candidate_columns": [
      "dxy_momentum_regime: Probability of being in trending regime (0-1). Low autocorrelation expected since regimes switch.",
      "dxy_cross_currency_divergence: Measure of disagreement among DXY component currencies (0-1 normalized). When high, DXY is being driven by one currency rather than broad USD strength/weakness.",
      "dxy_volatility_state: Realized FX volatility relative to historical norm (z-score or percentile). Elevated volatility often precedes gold price dislocations."
    ],
    "properties": [
      "All daily frequency, no interpolation",
      "No NaN values (after warmup period)",
      "Low multicollinearity with raw dxy_dxy",
      "Statistically meaningful (not just transformations of the level)"
    ]
  },

  "success_hypothesis": "DXY momentum regime and cross-currency divergence features, computed at daily frequency without interpolation, will provide the meta-model with USD context that improves direction accuracy by +0.5% or more. The daily-frequency advantage eliminates the root cause of real_rate's 5-attempt failure.",

  "success_criteria": {
    "gate1": {
      "overfit_ratio": "< 1.5 (if neural network used; N/A if deterministic)",
      "no_constant_output": true,
      "autocorrelation": "< 0.99 for all output columns"
    },
    "gate2": {
      "mi_increase": "> 5% (sum-based)",
      "vif": "< 10 for all submodel output columns",
      "rolling_correlation_std": "< 0.15"
    },
    "gate3": {
      "direction_accuracy_delta": "> +0.5%",
      "or_sharpe_delta": "> +0.05",
      "or_mae_delta": "< -0.01%",
      "note": "Any ONE of these three is sufficient to pass"
    }
  },

  "lessons_from_real_rate": {
    "lesson_1_frequency": "Monthly-to-daily interpolation was the root cause of all 5 real_rate failures. DXY data is daily -- this problem is eliminated.",
    "lesson_2_output_dimensionality": "More output columns gave XGBoost more noise dimensions to overfit on. Attempt 5 (7 columns) performed worse than Attempt 4 (2 columns) despite higher MI. Target 2-4 columns maximum.",
    "lesson_3_gate2_not_sufficient": "Gate 2 pass (MI increase) does NOT guarantee Gate 3 pass. All 5 real_rate attempts passed Gate 2 but failed Gate 3. Information must be in a form XGBoost can exploit without overfitting.",
    "lesson_4_vif_override": "Base features have existing multicollinearity (gld_close = etf_flow_gld_close). VIF must be computed carefully, using true R^2 regression if needed.",
    "lesson_5_deterministic_ok": "Deterministic approaches (PCA, state features) can pass Gate 1 trivially. If the researcher finds strong evidence for a deterministic approach, prefer it over neural networks for Attempt 1."
  },

  "previous_feedback": null,

  "created_at": "2026-02-14T21:00:00"
}
