{
  "feature": "cross_asset",
  "attempt": 1,
  "source": "entrance",
  "phase": "phase2_submodel",

  "objective": "Extract latent cross-asset relationship patterns -- correlation regime, relative value positioning, and structural divergence dynamics -- from gold's relationships with silver, copper, and S&P 500. The base features contain raw price levels (cross_asset_silver_close, cross_asset_copper_close, cross_asset_sp500_close) which tell the meta-model WHERE these assets are, but NOT: (a) whether gold-silver and gold-copper correlations are in a normal or dislocated regime, (b) whether gold is relatively cheap or expensive vs peers (gold/silver ratio extreme, gold/copper ratio signaling recession), (c) whether cross-asset relationships are converging or diverging (mean-reversion dynamics of relative pricing).",

  "requirements": "Build a submodel that captures: (1) Cross-asset correlation regime -- are gold's relationships with silver, copper, and equities in their normal state, or has a structural dislocation occurred (e.g., gold rallying while copper crashes = recession signal, gold rallying while silver lags = safe-haven premium, gold and equities both rising = liquidity-driven)? (2) Relative value position -- is gold expensive or cheap relative to historical relationships (gold/silver ratio z-score, gold/copper ratio z-score)? Extreme relative positions historically mean-revert. (3) Cross-asset momentum divergence -- are the assets moving together (risk-on/risk-off synchronized) or diverging (structural regime change underway)? Output exactly 3 daily features that capture fundamentally different dimensions of cross-asset dynamics.",

  "theoretical_background": {
    "why_cross_asset_matters_for_gold": "Gold does not trade in isolation. Its price reflects its relative attractiveness compared to alternative assets in three categories: (a) Precious metals peers (silver) -- silver tracks gold but with higher beta and industrial exposure; deviations in the gold/silver ratio signal shifts in safe-haven vs industrial demand. (b) Industrial metals (copper) -- gold/copper ratio is a well-known recession indicator because copper is pro-cyclical while gold is counter-cyclical; their ratio captures macro regime transitions. (c) Equities (S&P 500) -- gold vs equities reflects risk appetite; when both rise it signals liquidity, when gold rises and equities fall it signals fear. These RELATIVE dynamics contain information about why gold is moving, not just that it is moving.",
    "what_base_features_provide": "Three columns: cross_asset_silver_close, cross_asset_copper_close, cross_asset_sp500_close. These are raw closing price levels. They rank #2 (silver, 7.3%) and #3 (S&P 500, 6.5%) in baseline feature importance -- among the most important features. However, raw levels encode only absolute price positions. The meta-model cannot easily compute from levels alone: (a) whether the gold/silver ratio is at a 30-year extreme, (b) whether cross-asset correlations have shifted regime, (c) whether current divergences are expanding or contracting. These require relative computation and historical context.",
    "what_submodel_adds": "Three dimensions of cross-asset context: (1) CORRELATION REGIME -- captures whether the normal positive correlation between gold and silver (and negative correlation between gold and equities) is intact or broken, using rolling correlation dynamics. Regime shifts in correlation precede and signal major gold moves (e.g., 2020 COVID crash saw gold-equity correlation flip from negative to positive). (2) RELATIVE VALUE POSITION -- gold/silver and gold/copper ratios z-scored against their historical distributions, capturing whether gold is historically expensive or cheap relative to peers. Extreme positions predict mean-reversion. (3) DIVERGENCE DYNAMICS -- measures whether cross-asset spreads are expanding or contracting, capturing the velocity and direction of structural regime changes.",
    "key_cross_asset_relationships": {
      "gold_silver_ratio": "Historically averages 60-70 (ounces of silver per ounce of gold). Spikes above 80-90 during crises (silver has higher industrial beta, drops more). Drops below 50 during precious metals manias. The LEVEL of this ratio is a macro regime indicator. Its CHANGE predicts gold's relative trajectory.",
      "gold_copper_ratio": "Often called the 'recession gauge'. High ratio = recession fears (gold up, copper down). Low ratio = expansion (copper demand for construction/manufacturing). A well-documented macro indicator used by institutional investors.",
      "gold_sp500_correlation": "Normally negative (risk-on/risk-off). Flips positive during liquidity-driven rallies (QE periods) and crash panics (initial sell-everything phase). The REGIME of this correlation is more informative than the correlation level itself.",
      "precious_metals_momentum": "Silver typically leads gold in both rallies and selloffs due to higher beta. When silver begins outperforming gold (falling GSR), it often signals the start of a precious metals rally. Conversely, silver underperformance (rising GSR) can signal a topping process."
    },
    "difference_from_existing_submodels": "VIX submodel captures external fear dynamics. Technical submodel captures gold's own price dynamics. DXY submodel captures dollar dynamics. Cross-asset submodel captures RELATIVE positioning -- how gold's price compares to related assets. This is a fundamentally different information axis: the same gold price at $2000 means very different things if silver is at $22 (GSR=90, extreme safe-haven premium) vs silver at $40 (GSR=50, broad precious metals rally)."
  },

  "data_strategy": {
    "primary_data": {
      "source": "Yahoo Finance",
      "tickers": ["SI=F", "HG=F", "^GSPC"],
      "frequency": "daily",
      "note": "Silver futures, copper futures, S&P 500 index. All already available as base features. Cross-asset submodel works with RATIOS and CORRELATIONS of these with gold, not levels themselves."
    },
    "gold_reference": {
      "source": "Yahoo Finance",
      "ticker": "GC=F or GLD",
      "note": "Need gold price to compute ratios. GLD preferred (no roll artifacts, proven in technical submodel). Or use gold close from base_features directly."
    },
    "additional_candidates": [
      {
        "source": "Yahoo Finance",
        "ticker": "SI=F",
        "description": "Silver futures. Key for gold/silver ratio. Daily close sufficient.",
        "already_available": true
      },
      {
        "source": "Yahoo Finance",
        "ticker": "HG=F",
        "description": "Copper futures. Key for gold/copper ratio (recession gauge).",
        "already_available": true
      },
      {
        "source": "Yahoo Finance",
        "ticker": "^GSPC",
        "description": "S&P 500 index. Key for gold/equity correlation regime.",
        "already_available": true
      },
      {
        "source": "Yahoo Finance",
        "ticker": "SLV",
        "description": "Silver ETF. Backup for SI=F if futures have roll issues.",
        "already_available": false,
        "note": "Researcher should evaluate if SLV is needed"
      }
    ],
    "expected_samples": "~2523 daily observations (matching base_features date range 2015-01-30 to 2025-02-12)",
    "frequency_advantage": "All data is daily. No interpolation needed. Same daily-frequency advantage that made VIX and technical succeed on attempt 1."
  },

  "research_questions": [
    "What is the most effective method for detecting CORRELATION REGIME shifts between gold and peer assets (silver, copper, S&P 500)? Candidates: (a) HMM on a vector of rolling pairwise correlations (e.g., 3-dimensional input: corr(gold,silver), corr(gold,copper), corr(gold,sp500)), (b) DCC-GARCH (Dynamic Conditional Correlation) to estimate time-varying correlations and detect regime changes, (c) rolling correlation z-score (simpler but may miss nonlinear regime shifts). Which method produces the most informative single regime probability? The VIX/technical submodels succeeded with HMM -- does the same pattern work for correlation regime detection?",
    "Which cross-asset RATIO is most predictive for gold returns: (a) gold/silver ratio (GSR), (b) gold/copper ratio, (c) gold/S&P 500 ratio, or (d) a composite index? Specifically: what are the mean-reversion properties of each ratio? What is the typical half-life? What z-score window captures extremes that predict gold return direction? Academic or quantitative evidence preferred.",
    "How should DIVERGENCE DYNAMICS between gold and peer assets be measured? Candidates: (a) rate of change of cross-asset ratios (momentum of the ratio), (b) difference in standardized returns over a lookback period (who is outperforming), (c) PCA first component loading change (structural co-movement shift), (d) rolling beta of gold vs S&P 500 and its z-score. The goal is to capture whether cross-asset relationships are converging (normalizing) or diverging (structural shift underway).",
    "What is the empirical evidence for the gold/copper ratio as a recession indicator? Specifically: (a) at what z-score levels does the ratio become predictive? (b) does the ratio lead or lag gold returns? (c) is the signal captured by the rolling ratio level, or the rate of change? This matters because we need features that predict NEXT-DAY gold returns, not concurrent macro state.",
    "What lookback windows are optimal for cross-asset features? Specifically: (a) what window for rolling correlations best captures regime shifts without being too noisy (20d? 60d? 120d?)? (b) what window for ratio z-scores captures meaningful extremes (60d? 120d? 250d full year?)? Gold cross-asset relationships can persist for months (e.g., gold/silver ratio stayed above 80 for extended periods in 2019-2020). The window must be long enough to establish a baseline but short enough to detect shifts.",
    "What is the VIF risk between cross-asset submodel outputs and (a) existing base features (silver_close, copper_close, sp500_close) and (b) existing submodel outputs (vix_regime_probability, vix_mean_reversion_z, dxy_regime_probability)? Specifically: will a gold/silver ratio z-score correlate with silver_close or gold_close levels? Ratios of I(1) series can be I(0), so this needs empirical verification. Will a correlation regime feature overlap with the VIX regime probability (since equity volatility affects gold-equity correlation)?",
    "Should the cross-asset submodel use a single combined correlation regime (e.g., HMM on multi-dimensional correlation vector) or separate ratio-based features for each asset pair? The single-regime approach captures the overall cross-asset environment but loses pair-specific information. The separate approach preserves pair-specific signals but risks VIF issues if outputs are correlated. What does the literature suggest for gold specifically?"
  ],

  "candidate_approaches": {
    "approach_A_hmm_correlation_regime": {
      "description": "HMM on rolling correlation vector [corr(gold,silver), corr(gold,copper), corr(gold,sp500)] to detect cross-asset correlation regimes, plus gold/silver ratio z-score for relative value, plus cross-asset return divergence measure for dynamics. Follows the proven HMM + deterministic pattern.",
      "output": ["xasset_corr_regime_prob", "xasset_relative_value_z", "xasset_divergence"],
      "pros": "Follows proven HMM pattern from VIX/technical. Multi-dimensional HMM input captures joint correlation structure. Ratio z-score is well-established. Divergence measure captures dynamics.",
      "cons": "Rolling correlations as HMM input may be noisy (small sample within window). 3D HMM needs more data. May lose pair-specific information."
    },
    "approach_B_ratio_based_features": {
      "description": "Gold/silver ratio z-score (60d) for relative precious metals value, gold/copper ratio z-score (90d) for macro regime indicator, gold-vs-equity relative return (30d) for risk appetite divergence. All deterministic, no ML.",
      "output": ["xasset_gsr_zscore", "xasset_gcr_zscore", "xasset_equity_divergence"],
      "pros": "All deterministic (no overfitting). Well-established financial ratios. Each captures a different relationship (precious metals, industrial, equities). Simple and interpretable.",
      "cons": "May miss nonlinear regime shifts. Z-scores assume normal distribution of ratios. No regime detection component."
    },
    "approach_C_pca_correlation_dynamics": {
      "description": "PCA on rolling correlation matrix to extract dominant co-movement factor, combined with gold/silver ratio z-score and rolling beta of gold vs S&P 500. Captures structural co-movement changes.",
      "output": ["xasset_comovement_factor", "xasset_gsr_zscore", "xasset_gold_beta_z"],
      "pros": "PCA captures the dominant structural pattern in cross-asset relationships. Beta z-score directly measures gold's sensitivity to equities. Combines structural and pair-specific views.",
      "cons": "PCA on small correlation matrix (3x3) may not be informative. Rolling PCA can be unstable with short windows."
    },
    "approach_D_hybrid_hmm_plus_ratios": {
      "description": "HMM on joint cross-asset return vector [gold_ret, silver_ret, copper_ret, sp500_ret] for regime detection (identifies risk-on/risk-off/dislocation regimes), plus gold/silver ratio z-score for precious metals relative value, plus cross-asset momentum rank divergence for dynamics.",
      "output": ["xasset_regime_prob", "xasset_precious_metals_z", "xasset_rank_divergence"],
      "pros": "HMM on joint returns directly captures the cross-asset regime (risk-on vs risk-off vs dislocation). Ratio z-score proven concept. Rank divergence is robust to scale differences.",
      "cons": "4D HMM may need many states. Risk of overlapping with VIX regime (VIX also captures risk-on/risk-off)."
    }
  },

  "constraints": [
    "All data must be daily frequency from Yahoo Finance -- inherently same-day, well within 5-day delay limit",
    "Submodel does NOT predict gold prices -- it extracts cross-asset relationship patterns (correlation regimes, relative value positioning, divergence dynamics)",
    "Output must be exactly 3 columns (lessons from VIX/technical success with 3, real_rate failure with 7)",
    "Output must have VIF < 10 against ALL existing base features, especially: cross_asset_silver_close, cross_asset_copper_close, cross_asset_sp500_close (raw levels). Since submodel outputs are RATIOS or CORRELATIONS, they should be structurally different from levels, but empirical verification required",
    "Output must have VIF < 10 against existing submodel outputs: vix_regime_probability, vix_mean_reversion_z, vix_persistence, tech_trend_regime_prob, tech_mean_reversion_z, tech_volatility_regime",
    "Autocorrelation < 0.99 for all output columns. Ratio z-scores on long windows (120d+) may approach this threshold -- researcher must verify empirically",
    "Features must be computable at inference time without lookahead bias -- all rolling windows backward-looking, all model fits on training set only",
    "Avoid features that VIX submodel already captures. VIX regime already encodes risk-on/risk-off. Cross-asset submodel should capture RELATIVE PRICING dynamics, not generic risk appetite (to minimize overlap with vix_regime_probability)",
    "Avoid features that correlate strongly with DXY submodel outputs. Gold and DXY are inversely correlated, so a gold/equity correlation regime may partially overlap with DXY regime. Researcher should measure expected cross-correlations",
    "If using futures continuous contracts (SI=F, HG=F), handle roll artifacts -- use returns-based computations or verify ratio stability across roll dates",
    "All features must capture DYNAMICS (regime, position, divergence) not levels or simple derivatives that XGBoost could trivially compute from the three base feature columns"
  ],

  "output_schema": {
    "target_columns": 3,
    "candidate_columns": [
      "xasset_corr_regime_prob: Probability of being in a dislocated/abnormal cross-asset correlation regime vs normal regime. From HMM on rolling correlations or returns vector. Captures whether gold's relationships with peers are intact or broken. Range [0, 1].",
      "xasset_relative_value_z: Z-score of gold/silver ratio (or composite precious metals ratio) measuring whether gold is historically expensive or cheap relative to peers. Extreme values predict mean-reversion. Range [-4, +4].",
      "xasset_divergence: Measure of whether cross-asset relationships are converging (normalizing) or diverging (structural shift). Captures the velocity of relative price changes. Range varies by method."
    ],
    "properties": [
      "All daily frequency, no interpolation",
      "No NaN values after warmup period (max ~120 days for longest rolling window)",
      "Low multicollinearity with raw price level base features (VIF < 10). Key test: ratio z-scores should NOT correlate with silver_close or copper_close levels",
      "Low multicollinearity with VIX and technical submodel outputs (VIF < 10). Key test: correlation regime should NOT overlap with vix_regime_probability",
      "Each feature captures a DIFFERENT dimension: regime (normal vs dislocated), position (cheap vs expensive), dynamics (converging vs diverging)",
      "Features encode RELATIVE information that raw price levels cannot convey"
    ]
  },

  "success_hypothesis": "Cross-asset relative positioning (correlation regime, gold/silver ratio extremes, divergence dynamics) will provide the meta-model with relational context that improves direction accuracy by +0.5% or more. The key information gain comes from the fact that gold's return is partly determined by WHERE it sits relative to peers: gold at $2000 with silver at $22 (GSR=90) has very different forward return distribution than gold at $2000 with silver at $40 (GSR=50). Base features provide absolute levels but the submodel provides the relative context. Cross-asset features rank #2 and #3 in baseline importance (7.3% and 6.5%), suggesting the meta-model already finds value in the raw levels -- enriching with regime/relative/divergence context should amplify this.",

  "success_criteria": {
    "gate1": {
      "overfit_ratio": "< 1.5 (if neural network used; N/A if deterministic methods like HMM/rolling stats)",
      "no_constant_output": true,
      "autocorrelation": "< 0.99 for all output columns"
    },
    "gate2": {
      "mi_increase": "> 5% (sum-based, total MI of all features including submodel outputs vs without)",
      "vif": "< 10 for all submodel output columns",
      "rolling_correlation_std": "< 0.15"
    },
    "gate3": {
      "direction_accuracy_delta": "> +0.5%",
      "or_sharpe_delta": "> +0.05",
      "or_mae_delta": "< -0.01%",
      "note": "Any ONE of these three is sufficient to pass Gate 3"
    }
  },

  "lessons_from_previous_features": {
    "real_rate_failure": {
      "root_cause": "Monthly-to-daily frequency mismatch. 5 attempts, all passed Gate 2 (MI up to +39.3%) but failed Gate 3.",
      "lesson_applied": "Cross-asset data is inherently daily. No interpolation needed."
    },
    "real_rate_dimensionality": {
      "root_cause": "Attempt 5 used 7 output columns, giving XGBoost more noise surface to overfit.",
      "lesson_applied": "Exactly 3 output columns."
    },
    "vix_success": {
      "approach": "HMM regime + rolling z-score + rolling autocorrelation. 3 columns. DA +0.96%, Sharpe +0.289.",
      "lesson_applied": "Follow same structural pattern: regime detector + statistical position + dynamics measure."
    },
    "technical_success": {
      "approach": "HMM on 2D [returns, GK_vol] + z-score of returns + GK vol z-score. 3 columns. MAE -0.1824 (18x threshold).",
      "lesson_applied": "2D HMM input improves regime detection. Use the same multi-dimensional approach for correlation regimes. Daily GK vol (no smoothing) keeps autocorrelation low -- apply same principle to cross-asset features."
    },
    "dxy_completion": {
      "note": "DXY completed with MI=0.019 but full Gate 2/3 was not evaluated in detail. Its outputs (dxy_regime_probability, dxy_cross_currency_div, dxy_volatility_z) are in the pipeline. Cross-asset submodel must not duplicate DXY's dollar-relationship information.",
      "lesson_applied": "Avoid gold/dollar relationships -- that is DXY's domain. Focus on gold/silver, gold/copper, gold/equity relationships."
    },
    "gate2_not_sufficient": {
      "lesson": "Gate 2 MI pass does NOT guarantee Gate 3. Features must be in a form that XGBoost can exploit for directional prediction. Ratio z-scores at extremes provide natural split points for XGBoost."
    },
    "high_base_feature_importance": {
      "lesson": "Silver_close (7.3%) and sp500_close (6.5%) are already top-3 base features. This means the meta-model already finds cross-asset levels valuable. Adding RELATIVE and REGIME context should be complementary, not redundant. But it also means VIF risk is real -- the submodel outputs must be structurally different from levels."
    }
  },

  "vif_risk_analysis": {
    "critical_base_features": {
      "cross_asset_silver_close": "Raw silver price level. Rank #2 in baseline importance (7.3%). A gold/silver RATIO z-score should have low correlation with silver LEVEL because the ratio captures the relative relationship, not silver's absolute price. But empirical verification needed -- if silver and gold move together, the ratio may have low variance.",
      "cross_asset_copper_close": "Raw copper price level. Gold/copper RATIO z-score should be orthogonal to copper level for similar reasons.",
      "cross_asset_sp500_close": "Raw S&P 500 level. Rank #3 in baseline importance (6.5%). A gold/equity divergence feature should have low correlation with S&P level because it captures the DIFFERENCE in behavior, not the equity level itself."
    },
    "existing_submodel_correlation_risk": {
      "vix_regime_probability": "HIGHEST RISK. VIX regime captures risk-on/risk-off. Cross-asset correlation regime may also capture risk-on/risk-off (since correlations shift during crises). Researcher MUST measure expected correlation and design to minimize overlap. Strategy: focus cross-asset regime on PRECIOUS METALS relationships (gold/silver) rather than gold/equity, since gold/equity correlation is partly captured by VIX.",
      "vix_mean_reversion_z": "Low risk. VIX z-score captures VIX-specific mean-reversion. Cross-asset z-score captures ratio-specific mean-reversion. Different instruments.",
      "tech_trend_regime_prob": "Moderate risk. Gold's own trend regime may correlate with cross-asset divergence (when gold trends, it may diverge from peers). Expected correlation 0.1-0.3.",
      "tech_volatility_regime": "Low risk. Gold's GK vol regime is gold-specific OHLC data. Cross-asset features use ratios and correlations.",
      "dxy_regime_probability": "Moderate risk. Dollar regime affects gold-equity correlation. Cross-asset regime should focus on non-dollar relationships to minimize overlap."
    },
    "mitigation": "Design cross-asset features around PRECIOUS METALS ratios (gold/silver, gold/copper) rather than gold/equity correlation, since the latter overlaps more with VIX and DXY. The gold/silver and gold/copper ratios capture information that NO existing submodel addresses: metal-specific supply/demand dynamics and industrial vs safe-haven demand shifts."
  },

  "unique_advantages_of_cross_asset_submodel": [
    "RELATIVE POSITIONING: Only submodel that captures gold's value RELATIVE to peers. Same gold price has very different implications depending on silver, copper, and equity context.",
    "COMMODITY-SPECIFIC INFORMATION: Gold/silver and gold/copper ratios encode precious metals and industrial demand dynamics that VIX, DXY, and technical submodels cannot capture.",
    "HIGH BASE IMPORTANCE: Silver (7.3%) and S&P 500 (6.5%) are top-3 base features. Adding relational context to already-important features should have high marginal value.",
    "PROVEN RATIOS: Gold/silver ratio and gold/copper ratio are established financial indicators used by institutional investors. Strong theoretical backing.",
    "DAILY FREQUENCY: All Yahoo Finance data is daily. No interpolation needed (real_rate lesson applied)."
  ],

  "previous_feedback": null,

  "created_at": "2026-02-14T23:50:00"
}
