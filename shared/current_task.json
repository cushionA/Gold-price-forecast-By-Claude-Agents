{
  "feature": "real_rate",
  "attempt": 10,
  "phase": "phase2_submodel_retry",
  "created_at": "2026-02-21",
  "agent_sequence": ["architect", "builder_data", "datachecker", "builder_model"],

  "objective": "Build a real interest rate submodel attempt 10 using a fundamentally different feature extraction approach from attempts 7-9. Use PCA on daily DFII changes to produce data-driven orthogonal features, avoiding the hand-crafted Sharpe-MAE tradeoff observed in attempts 7-9.",

  "background": {
    "attempt_7_result": "Gate 3 PASS via Sharpe +0.329 (6.6x threshold). 4 features: rr_level_change_z, rr_slope_chg_z, rr_curvature_chg_z, rr_slope_level_z. BEST overall attempt.",
    "attempt_8_result": "Gate 3 PASS via MAE -0.0203 (2.0x threshold). 3 features: removed rr_slope_level_z. Sharpe reversed to -0.260.",
    "attempt_9_result": "Gate 3 PASS via MAE -0.0141 (1.4x threshold). 5 features: attempt 7 + interaction. STRICTLY WORSE than attempt 8 on ALL metrics. Combination strategy failed.",
    "fundamental_tradeoff": "rr_slope_level_z (252-day rolling z-score, autocorr=0.937) drives Sharpe improvement but hurts MAE/DA. Without it, MAE improves but Sharpe degrades. Adding more hand-crafted features (attempt 9) makes everything worse.",
    "key_lesson": "Hand-crafted feature combinations have been exhausted. Need fundamentally different approach."
  },

  "previous_feedback": {
    "attempt_9_gate3": "PASS via MAE (-0.0141) but strictly worse than attempt 8 on all metrics",
    "anti_patterns": [
      "DO NOT add features on top of attempt 7 set (attempt 9 proved counterproductive)",
      "DO NOT use rr_slope_level_z and expect MAE improvement (structural tradeoff)",
      "DO NOT remove rr_slope_level_z and expect Sharpe improvement (structural tradeoff)",
      "DO NOT use 252-day rolling window for level features (causes autocorr=0.937)"
    ]
  },

  "design_approach": {
    "name": "PCA on Daily DFII Changes",
    "data_sources": [
      "FRED: DFII5 (5Y TIPS yield, daily)",
      "FRED: DFII7 (7Y TIPS yield, daily)",
      "FRED: DFII10 (10Y TIPS yield, daily)",
      "FRED: DFII20 (20Y TIPS yield, daily)",
      "FRED: DFII30 (30Y TIPS yield, daily)"
    ],
    "feature_design": {
      "approach": "Compute daily changes for all 5 DFII series. Apply rolling PCA (window 252 or expanding) to the 5-dimensional change vector. Output the projection onto the top 2-3 principal components as rolling z-scores.",
      "rationale": "PCA produces orthogonal components by construction. No autocorrelation issue since we use daily changes not levels. Data-driven -- not biased by hand-crafted assumptions about which combinations matter."
    },
    "alternative": {
      "approach": "Exponential decay weighting. Same 3 change features as attempt 8 but add a 4th feature: EWM slope level with half-life 10-20 days (instead of 252-day rolling). This captures the same information as rr_slope_level_z but with much lower autocorrelation.",
      "rationale": "Short memory exponential decay may preserve the Sharpe signal from rr_slope_level_z while avoiding the autocorrelation problem that hurts MAE."
    },
    "architect_decides": "Choose PCA approach (priority 1) or exponential decay (priority 2) based on feasibility and expected information content"
  },

  "output_spec": {
    "file": "data/processed/real_rate/data.csv",
    "format": "CSV with date index",
    "columns": "2-4 features, architect decides",
    "date_range": "Matching target.csv",
    "nan_handling": "NaN for warmup period. No forward-fill."
  },

  "constraints": [
    "Maximum 4 output features",
    "All sources must be daily frequency from FRED",
    "No forward-fill of monthly-to-daily",
    "No neural network training required -- pure deterministic features",
    "FRED API key via Kaggle Secrets (UserSecretsClient)",
    "kernel-metadata.json must include dataset_sources: ['bigbigzabuton/gold-prediction-submodels']"
  ],

  "success_criteria": {
    "gate1": "No overfitting, no all-NaN or constant columns",
    "gate2": "MI increase > 5%",
    "gate3": "Any one of: DA +0.5pp, Sharpe +0.05, MAE -0.01%. Goal: beat attempt 7 Sharpe +0.329 or attempt 8 MAE -0.0203. Realistically, matching either would be a success."
  },

  "kaggle_config": {
    "kernel_id": "bigbigzabuton/gold-real-rate-10",
    "notebook_path": "notebooks/real_rate_10/",
    "dataset_sources": ["bigbigzabuton/gold-prediction-submodels"]
  }
}
