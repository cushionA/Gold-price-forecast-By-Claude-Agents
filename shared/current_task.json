{
  "feature": "real_rate",
  "attempt": 7,
  "phase": "phase2_submodel_retry",
  "created_at": "2026-02-21",
  "agent_sequence": ["researcher", "architect", "builder_data", "datachecker", "builder_model"],

  "objective": "Build a real interest rate yield curve shape submodel using daily DFII5/DFII7/DFII10/DFII20/DFII30 series from FRED. Extract shape characteristics (slope, curvature, level velocity) as deterministic features without any monthly-to-daily forward-fill interpolation.",

  "background": {
    "previous_attempts_summary": {
      "attempt_1": "MLP Autoencoder - Gate1 FAIL (overfit 2.69, autocorr>0.99)",
      "attempt_2": "GRU Autoencoder - all Optuna trials pruned, GRU convergence failure",
      "attempt_3": "Multi-country Transformer - Gate2 PASS (MI +23.8%), Gate3 FAIL - forward-fill step function caused MAE degradation",
      "attempt_4": "PCA + Cubic Spline - Gate2 PASS (MI +10.29%), Gate3 FAIL - all metrics degraded in all 5 folds",
      "attempt_5": "Markov + CUSUM (7 cols) - Gate2 PASS (MI +39.3%), Gate3 FAIL - worst degradation ever",
      "attempt_6": "Deterministic Vol+Momentum (US-only daily DFII10) - Gate2 FAIL (MI 1.95%), Gate3 FAIL"
    },
    "root_cause_analysis": {
      "monthly_data_problem": "Attempts 3-5 used monthly TIPS data forward-filled to daily. This step-function creates artificial persistence that degrades MAE even when MI is high.",
      "single_series_problem": "Attempt 6 used only daily DFII10. Single series provides insufficient information (MI +1.95%) despite being clean daily data.",
      "solution": "Use MULTIPLE daily DFII series (DFII5, DFII7, DFII10, DFII20, DFII30) to extract curve SHAPE, not level. Shape features are orthogonal to the raw DFII10 already in base_features."
    },
    "key_insight": "Attempt 3 confirmed information exists in real rates (MI +23.8%). The problem was HOW to extract it. Yield curve shape features from multiple daily DFII series avoid both the monthly forward-fill problem AND the single-series information insufficiency."
  },

  "design_approach": {
    "name": "Real Yield Curve Shape Features (Daily DFII Multi-Tenor)",
    "data_sources": [
      "FRED: DFII5 (5Y TIPS yield, daily)",
      "FRED: DFII7 (7Y TIPS yield, daily)",
      "FRED: DFII10 (10Y TIPS yield, daily)",
      "FRED: DFII20 (20Y TIPS yield, daily)",
      "FRED: DFII30 (30Y TIPS yield, daily)"
    ],
    "feature_design": {
      "rr_slope_z": "Z-score of daily change in (DFII30 - DFII5). Window 60 days. Captures steepening/flattening dynamics.",
      "rr_curvature_z": "Z-score of (2*DFII10 - DFII5 - DFII30). Window 60 days. Captures belly distortion.",
      "rr_level_change_z": "Z-score of DFII10 daily change. Window 30 days. Captures level velocity.",
      "rr_slope_level": "Raw value of (DFII30 - DFII5). Absolute slope regime signal (optional 4th feature)."
    },
    "max_features": 4,
    "model_type": "Deterministic transformation (no neural network needed)",
    "rationale": "Pure deterministic features avoid overfitting entirely. All series are daily (no forward-fill). Features are designed to be orthogonal to DFII10 raw level already in base_features."
  },

  "output_spec": {
    "file": "data/processed/real_rate/data.csv",
    "format": "CSV with date index",
    "columns": ["rr_slope_z", "rr_curvature_z", "rr_level_change_z"],
    "optional_4th": "rr_slope_level if architect deems useful",
    "date_range": "2015-01-02 to 2025-02-12 (matching target.csv)",
    "nan_handling": "NaN allowed where DFII series unavailable (first 30-60 days for z-score warmup). Do NOT forward-fill across missing values."
  },

  "constraints": [
    "Maximum 4 output features",
    "No monthly data (all sources must be daily frequency from FRED)",
    "No forward-fill of monthly-to-daily (this was the root cause of attempts 3-5 failure)",
    "No neural network training required - pure deterministic features",
    "FRED API key via environment variable or Kaggle Secrets",
    "kernel-metadata.json must include dataset_sources: ['bigbigzabuton/gold-prediction-submodels']",
    "Kaggle notebook: use UserSecretsClient for FRED_API_KEY"
  ],

  "success_criteria": {
    "gate1": "No overfitting (deterministic features: always pass), no all-NaN or constant columns",
    "gate2": "MI increase > 5% (attempt 3 showed MI +23.8% is achievable with real rate curve info)",
    "gate3": "Any one of: DA +0.5pp, Sharpe +0.05, MAE -0.01%"
  },

  "kaggle_config": {
    "kernel_id": "bigbigzabuton/gold-real-rate-7",
    "notebook_path": "notebooks/real_rate_7/",
    "dataset_sources": ["bigbigzabuton/gold-prediction-submodels"]
  },

  "research_questions": [
    "Confirm FRED DFII5, DFII7, DFII10, DFII20, DFII30 are available as daily series",
    "Verify the exact FRED series IDs for each tenor",
    "Check historical coverage: when did each series start? DFII5 may have shorter history.",
    "Confirm no forward-fill will be needed: are these series truly daily business day frequency?",
    "Verify: is slope (30Y-5Y) a known predictor of gold prices in academic literature?",
    "Is curvature (2*10Y - 5Y - 30Y) used in bond/commodity research?"
  ]
}
